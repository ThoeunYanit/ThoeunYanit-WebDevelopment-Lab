<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Register</title>
  <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>

</head>
<body class="bg-gray-100 min-h-screen flex flex-col items-center justify-start py-10 px-4">

  <!-- Register Form Card -->
  <div class="bg-white rounded-2xl shadow-lg p-8 w-full max-w-xl mb-6">
    <!-- Header -->
    <div class="flex items-center justify-between mb-1">
      <h1 class="text-2xl font-bold text-gray-900">Register User</h1>
      <button
        onclick="logout()"
        class="bg-red-500 hover:bg-red-600 text-white text-sm font-semibold px-4 py-2 rounded-lg transition cursor-pointer"
      >
        Logout
      </button>
    </div>

    <p id="welcome" class="text-green-600 text-sm font-medium mb-6"></p>

    <label class="block text-sm font-medium text-gray-600 mb-1">Full Name</label>
    <input
      type="text" id="fullName"
      class="w-full border border-gray-300 rounded-lg px-4 py-3 text-sm text-gray-700 focus:outline-none focus:border-violet-600 transition mb-5"
    />

    <label class="block text-sm font-medium text-gray-600 mb-1">Email</label>
    <input
      type="email" id="email"
      class="w-full border border-gray-300 rounded-lg px-4 py-3 text-sm text-gray-700 focus:outline-none focus:border-violet-600 transition mb-5"
    />

    <label class="block text-sm font-medium text-gray-600 mb-1">Phone</label>
    <input
      type="tel" id="phone"
      class="w-full border border-gray-300 rounded-lg px-4 py-3 text-sm text-gray-700 focus:outline-none focus:border-violet-600 transition mb-6"
    />

    <div class="flex gap-3">
      <button
        onclick="clearForm()"
        class="flex-1 bg-pink-500 hover:bg-pink-600 active:bg-pink-700 text-white font-semibold py-3 rounded-lg transition text-sm cursor-pointer"
      >
        Clear
      </button>
      <button
        onclick="registerUser()"
        class="flex-1 bg-violet-600 hover:bg-violet-700 active:bg-violet-800 text-white font-semibold py-3 rounded-lg transition text-sm cursor-pointer"
      >
        Register
      </button>
    </div>
  </div>

  <!-- Registered Users Table Card -->
  <div class="bg-white rounded-2xl shadow-lg p-8 w-full max-w-xl">
    <h2 class="text-xl font-bold text-gray-900 mb-5">Registered Users</h2>
    <table class="w-full text-sm">
      <thead>
        <tr class="border-b border-gray-200">
          <th class="text-left text-xs font-semibold text-gray-400 pb-3 pr-4">Full Name</th>
          <th class="text-left text-xs font-semibold text-gray-400 pb-3 pr-4">Email</th>
          <th class="text-left text-xs font-semibold text-gray-400 pb-3 pr-4">Phone</th>
          <th class="text-left text-xs font-semibold text-gray-400 pb-3">Action</th>
        </tr>
      </thead>
      <tbody id="userTableBody"></tbody>
    </table>
  </div>

  <script>
    // -------------------- PAGE LOAD CHECK --------------------
    window.onload = function () {
      const username = getCookie('username');
      if (!username) {
        window.location.href = 'login.html';
      } else {
        document.getElementById('welcome').innerText = 'Welcome, ' + username;
        renderTable();
      }
    };

    function getCookie(name) {
      for (let c of document.cookie.split('; ')) {
        const [key, val] = c.split('=');
        if (key === name) return decodeURIComponent(val);
      }
      return null;
    }

    function logout() {
      document.cookie = 'username=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;';
      window.location.href = 'login.html';
    }

    function getUsers() {
      return JSON.parse(localStorage.getItem('users') || '[]');
    }

    function saveUsers(users) {
      localStorage.setItem('users', JSON.stringify(users));
    }

    function registerUser() {
      const fullName = document.getElementById('fullName').value.trim();
      const email    = document.getElementById('email').value.trim();
      const phone    = document.getElementById('phone').value.trim();
      if (!fullName || !email || !phone) { alert('Please fill in all fields.'); return; }

      const users = getUsers();
      users.push({ fullName, email, phone });
      saveUsers(users);
      clearForm();
      renderTable();
    }

    function clearForm() {
      document.getElementById('fullName').value = '';
      document.getElementById('email').value    = '';
      document.getElementById('phone').value    = '';
    }

    function deleteUser(index) {
      const users = getUsers();
      users.splice(index, 1);
      saveUsers(users);
      renderTable();
    }

    function renderTable() {
      const users = getUsers();
      const tbody = document.getElementById('userTableBody');
      tbody.innerHTML = '';

      if (users.length === 0) {
        tbody.innerHTML = `
          <tr>
            <td colspan="4" class="text-center text-gray-300 py-6">No users registered yet.</td>
          </tr>`;
        return;
      }

      users.forEach((u, i) => {
        const tr = document.createElement('tr');
        tr.className = 'border-b border-gray-100';
        tr.innerHTML = `
          <td class="py-3 pr-4 text-gray-700">${u.fullName}</td>
          <td class="py-3 pr-4 text-gray-500">${u.email}</td>
          <td class="py-3 pr-4 text-gray-500">${u.phone}</td>
          <td class="py-3">
            <button
              onclick="deleteUser(${i})"
              class="bg-red-500 hover:bg-red-600 text-white text-xs font-semibold px-3 py-1.5 rounded-md transition cursor-pointer"
            >Delete</button>
          </td>
        `;
        tbody.appendChild(tr);
      });
    }
  </script>
</body>
</html>